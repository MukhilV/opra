{% extends 'polls/base.html' %}
{% load poll_extra %}
{% load static%}

{% block content %}
<div class="col-md-12">
        <h1>{{ question.question_text }}</h1>

        <ul>
        {% for response in question.response_set.all %}
            {% if response.allocation.item_text %}
                {{ response.user.username }}: {{ response.allocation.item_text }} (last Updated: {{ response.timestamp }}) <br />
                {% for dict in response.dictionary_set.all %}
                    {% for item in dict.sorted_values %}
                       <button type="button" class="btn btn-default">({{ item.1 }}) {{ item.0 }}</button>
                    {% endfor %}
                {% endfor %}
                <br />
            {% endif %}
        {% endfor %}
        </ul>
    </div>


    <br><br>
    <div class="col-md-12">
    Bundles: 
    <div class="panel-body">
        <div class="table-responsive">
            <table class="table">
                <tr>
                    <th>Candidates</th>
                    <th>Bundles</th>
                    <th>Value</th>
                </tr>
                {% for items in allocated_items %}
                <tr>
                    <td>{{ candidates|index:forloop.counter0 }}</td>
                    <td>{{ items }}</td>
                    <td>{{ sum_of_alloc_items_values|index:forloop.counter0 }}</td>
                </tr>
                {% endfor %}
                
            </table>
        </div>
    </div>
    

    <br><br>
    Allocation: 
    <div class="panel-body">
        <div class="table-responsive">
            <table class="table">
                <tr>
                    <th>Candidates</th>
                    {% for item in items %}
                        <th>{{ item }}</th>
                    {% endfor %}
                </tr>
                {% for row in allocation_matrix %}
                <tr>
                    <td>{{ candidates|index:forloop.counter0 }}</td>
                    {% for entry in row %}
                    <td>{{ entry }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>


    <br><br>
    Envy matrix: 
    <div class="panel-body">
        <div class="table-responsive">
            <table class="table">
                <tr>
                    <th>Candidates</th>
                    {% for candidate in candidates %}
                        <th>{{ candidate }}</th>
                    {% endfor %}
                </tr>
                {% for row in envy_matrix %}
                <tr>
                    <td>{{ candidates|index:forloop.counter0 }}</td>
                    {% for entry in row %}
                    <td>{{ entry }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>

    <br><br>
    EF1 matrix: 
    <div class="panel-body">
        <div class="table-responsive">
            <table class="table">
                <tr>
                    <th>Candidates</th>
                    {% for candidate in candidates %}
                        <th>{{ candidate }}</th>
                    {% endfor %}
                </tr>
                {% for row in ef1_matrix %}
                <tr>
                    <td>{{ candidates|index:forloop.counter0 }}</td>
                    {% for entry in row %}
                    <td>{{ entry }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>

{% endblock %}
