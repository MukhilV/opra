


<ul class="list-group">
    <form id="choiceform"  action="{% url 'polls:editchoice' question.id %}" method="post">
        {% csrf_token %}
    {% for item in items %}
            <li class="list-group-item ">
                {% if item.image %}  
                    <img src='/{{ item.image }}'/>
                {% endif %}
                {% if item.imageURL != Null %}
                    <img src='{{ item.imageURL }}'/>
                {% endif %}
                <div class="row">
                    <div class="form-group col-xs-1" data-toggle="collapse" data-target="#iteminfo{{item.id}}">
                        <span  class="caret" style="color:#377BB5;"></span>   
                    </div>   
                    <div class="form-group col-xs-7">
                        {% if question.status == 1 %}
                        <input type="text" class="form-control auto_submit" name="item{{item.id}}" size="50" value="{{ item }}" />
                        {% else %}
                        {{item}}
                        {% endif %}
                    </div>
                    {% if question.status == 1 %}
                    <div class="form-group col-xs-4">
                    <a href="{% url 'polls:delchoice' item.id %}">
                        <div class="pull-right">
                            <span class="glyphicon glyphicon-remove"></span>
                        </div>
                    </a>
                </div>
				{% endif %}
                </div>
                <div id="iteminfo{{item.id}}" class="accordian-body collapse">
                    <div class="row">
                        <div class="form-group col-xs-1">
                        </div>
                        <div class="form-group col-xs-9">
                    <p>Additional Description:</p>
						{% if question.status == 1 %}
                        <textarea class="form-control auto_submit" name="itemdescription{{item.id}}">{% if item.item_description %}{{item.item_description}}{% endif %}</textarea>
						{% else%}
						<p>{% if item.item_description %}{{item.item_description}}{% else %}None{% endif %}</p>
						{% endif %}
                        <br />
                        </div>
                    </div>
                        {% if item.image %}
                        <img class="item" src='/{{ item.image.url }}'/>
                        {% endif %}
                        {% if item.imageURL != Null %}
                        <img class="item" src='{{ item.imageURL }}'/>
                        {% endif %}
						{% if question.status == 1 %}
                        <div class="row">
                            <div class="form-group col-xs-1">
                            </div>
                        <div class="form-group col-xs-9">
                        <input type="text" class="form-control" name="imageURL{{item.id}}" value="{% if item.imageURL %}{{item.imageURL}}{% endif %}" size="50" placeholder="Paste Image URL"/>
                        </div>
                        <div class="form-group col-xs-2">
                        <label for="image{{item.id}}" class="btn btn-default"><span class="glyphicon glyphicon-camera"></span></label>
                        <input style="display:none" id="image{{item.id}}" type="file" name="docfile{{item.id}}" accept="image/*">
                        </div>
                        </div>
						{% endif %}
                </div>
            </li>
    {% endfor %}
    </form>
    
    <li class="list-group-item">
        <form action="{% url 'polls:addchoice' question.id %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="row">
            <div class="col-xs-6 form-group">
                <input type="text" class="form-control" name="choice" value="" size="50" placeholder="Option name" autofocus/>
            </div>

            <div class="col-xs-4 form-group">
                <input type="text" class="form-control" name="imageURL" value="" size="50" placeholder="Paste Image URL"/>
            </div>
            <div class="col-xs-2 form-group">
            <label for="image" class="btn btn-default"><span class="glyphicon glyphicon-camera"></span></label>
            <input style="display:none" id="image" type="file" name="docfile" accept="image/*">

            <button type="submit" class="btn btn-primary">
                <span class="glyphicon glyphicon-plus"></span>
            </button>
            </div>
            </div>
        </form>
    </li>
</ul>
<script>
        $(".auto_submit").each(function(){
            $(this).change(function(){
                this.form.submit(function(event){
				event.preventDefault();
				var url = $(location).attr('href');
				$.ajax({
					type:'post',
					url:url,
					data: $('#choiceform').serialize(),
					success: function(event){
						$('ul').load(location.href + " ul");
					}
				});
			});
					});
				});
</script>